# Nix Darwin Kickstarter - Minimal

 A basic configuration comprising essential settings for initiating nix-darwin. It can be safely deployed to your system.

## How to Use

1. Install Nix package manager via [Nix Official](https://nixos.org/download.html#nix-install-macos) or [DeterminateSystems/nix-installer](https://github.com/DeterminateSystems/nix-installer).
2. Read all the files in this `minimal` folder, and understand what they do.
   1. If you have trouble understanding, [ryan4yin/nixos-and-flakes-book](https://github.com/ryan4yin/nixos-and-flakes-book) is a good resource to learn nix and flakes.
3. Install Homebrew, see <https://brew.sh/>
   1. Homebrew is required to install most of the GUI apps, App Store's apps, and some CLI apps that are not available in nix's package repository `nixpkgs`.
4. Search `TODO` in this `minimal` folder, and complete all the TODOs.
5. Run the following command in the root of your nix configuration to start your nix-darwin journey(please change `hostname` to your hostname):
   ```bash
	nix build .#darwinConfigurations.hostname.system \
		--extra-experimental-features 'nix-command flakes'

	./result/sw/bin/darwin-rebuild switch --flake .#hostname
   ```

To simplify the command, adding the following content by create a `Makefile` in the root of your nix configuration:

```makefile
# please change 'hostname' to your hostname
deploy:
	nix build .#darwinConfigurations.hostname.system \
	   --extra-experimental-features 'nix-command flakes'

	./result/sw/bin/darwin-rebuild switch --flake .#hostname
```

Then you can run `make deploy` in the root of your nix configuration to deploy your configuration.

## Configuration Structure

Your current nix-darwin configuration's structure should be as follows:

```bash
› tree
.
├── flake.lock  # a lock file generated by nix, you can ignore it for now
├── flake.nix   # the entry point of your nix configuration, you need to add your hostname here
├── modules     # a folder contains all your nix-darwin configuration files
│   ├── apps.nix        # contains all your homebrew & nix apps(both GUI & CLI)
│   ├── host-users.nix  # defines your hostname & all your system users
│   ├── nix-core.nix    # nix's core configuration, you can ignore it for now
│   └── system.nix      # defines your macOS's system configuration(like dock, trackpad, keyboard, finder, loginwindow, etc.)
├── home           # Home Manager configuration for user-level settings
│   ├── default.nix    # Home Manager entry point
│   ├── shell.nix      # shell configuration
│   ├── git.nix        # git configuration with gitalias
│   ├── gh.nix         # GitHub CLI configuration with awesome-gh-aliases
│   └── ...other modules...
└── README.md
```

## Git Aliases (Gitalias)

This configuration includes [gitalias](https://github.com/ruchirajkarki/gitalias) - a collection of mnemonic git aliases derived from command names. The aliases follow a pattern where short sequences represent full git commands.

### Common Git Alias Examples

| Alias | Command | Description |
|-------|---------|-------------|
| `git a` | `add` | Stage files |
| `git aa` | `add --all` | Stage all changes |
| `git cm` | `commit --message` | Commit with message |
| `git p` | `push` | Push commits |
| `git l` | `pull` | Pull changes |
| `git sm` | `switch main` | Switch to main branch |
| `git sc` | `switch --create` | Create and switch to new branch |
| `git st` | `status` | Check status |
| `git dc` | `diff --cached` | View staged changes |
| `git th` | `reset --hard` | Hard reset |
| `git br` | `branch --remotes` | List remote branches |
| `git lg` | `log` | View commit log |
| `git go` | `log --oneline` | View commits in compact format |

### Git Alias Categories

- **add**: `a`, `aa`, `ai`, `ap`, `au`
- **branch**: `b`, `ba`, `bav`, `bc`, `bd`, `bm`, `br`, `bv`
- **commit**: `c`, `ca`, `cam`, `cm`
- **diff**: `d`, `dc`, `dfi`, `dno`, `dns`, `ds`
- **push**: `p`, `pa`, `pd`, `pf`, `po`, `pt`
- **pull**: `l`, `la`, `ld`, `lr`, `lv`
- **switch/branch**: `s`, `sc`, `sdc`, `sf`, `sm`
- **reset**: `t`, `th`, `tm`, `ts`
- **stash**: `h`, `ha`, `hc`, `hd`, `hl`, `hp`, `hs`
- **log**: `g`, `ga`, `gf`, `go`, `gp`, `gs`

For the complete list of all 170+ aliases, check [home/git.nix](home/git.nix).

## GitHub CLI Aliases (awesome-gh-aliases)

This configuration includes [awesome-gh-aliases](https://github.com/yashbhutwala/awesome-gh-aliases) - useful aliases and API scripts for the GitHub CLI (`gh`).

### Common GitHub CLI Alias Examples

| Alias | Command | Description |
|-------|---------|-------------|
| `gh pv` | `pr view` | View current PR |
| `gh bugs` | `issue list --label="bugs"` | List issues labeled as bugs |
| `gh user` | `api user` | Fetch authenticated user info as JSON |

### Advanced GitHub CLI Aliases

These aliases use GraphQL queries with pagination:

- **`gh list-milestones`**: List open milestones for the current repository
  ```bash
  gh list-milestones
  ```

- **`gh pr-files-changed <PR_NUM>`**: List files changed in a pull request
  ```bash
  gh pr-files-changed 42
  ```

- **`gh list-repos <USERNAME>`**: List repositories for a specific user
  ```bash
  gh list-repos octocat
  ```

- **`gh search-repos <COUNT> <QUERY>`**: Search repositories with star counts
  ```bash
  gh search-repos 10 "language:go stars:>1000"
  ```

For more details, check [home/gh.nix](home/gh.nix).


## Notes on Network Proxy

If you are in a network environment that requires proxy(such as China), you may need to set up proxy for nix and homebrew.

Please refer to the `rich-demo` folder for more details:

- [rich-demo/scripts/darwin_set_proxy.py](/rich-demo/scripts/darwin_set_proxy.py)
- [rich-demo/Makefile](/rich-demo/Makefile)
- [rich-demo - homebrew's mirror settings](/rich-demo/modules/homebrew-mirror.nix)


